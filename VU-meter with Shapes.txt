Private Sub tmrVU1_Timer(Index As Integer)
    If GetLoWord(BASS_ChannelGetLevel(BASS_FX_TempoGetResampledHandle(deck(Index)))) > 128 Then
        vuL(Index).Height = 10
        vuR(Index).Height = 10
        vuPeakL(Index).Y1 = vuL(Index).top
        vuPeakL(Index).Y2 = vuL(Index).top
        vuPeakR(Index).Y1 = vuR(Index).top
        vuPeakR(Index).Y2 = vuR(Index).top
        Exit Sub
    End If
    vuL(Index).Height = GetLoWord(BASS_ChannelGetLevel(BASS_FX_TempoGetResampledHandle(deck(Index)))) * 13.203125
    vuR(Index).Height = GetHiWord(BASS_ChannelGetLevel(BASS_FX_TempoGetResampledHandle(deck(Index)))) * 13.203125
    If vuL(Index).Height + vuL(Index).top > vuPeakL(Index).Y1 Then
        vuPeakL(Index).Y1 = vuL(Index).Height + vuL(Index).top
        vuPeakL(Index).Y2 = vuL(Index).Height + vuL(Index).top
    Else
        If vuPeakL(Index).Y1 < vuL(Index).top Then
            vuPeakL(Index).Y1 = vuL(Index).top
            vuPeakL(Index).Y2 = vuL(Index).top
        Else
            vuPeakL(Index).Y1 = vuPeakL(Index).Y1 - 20
            vuPeakL(Index).Y2 = vuPeakL(Index).Y2 - 20
        End If
    End If
    If vuR(Index).Height + vuR(Index).top > vuPeakR(Index).Y1 Then
        vuPeakR(Index).Y1 = vuR(Index).Height + vuR(Index).top
        vuPeakR(Index).Y2 = vuR(Index).Height + vuR(Index).top
    Else
        If vuPeakR(Index).Y1 < vuR(Index).top Then
            vuPeakR(Index).Y1 = vuR(Index).top
            vuPeakR(Index).Y2 = vuR(Index).top
        Else
            vuPeakR(Index).Y1 = vuPeakR(Index).Y1 - 20
            vuPeakR(Index).Y2 = vuPeakR(Index).Y2 - 20
        End If
    End If
End Sub

 
 


heh, my code in VB

used shapes and lines, btw i have 2 channels so that should explain the index stuff